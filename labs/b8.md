---
title: Lab 8 - Security Fundamentals
layout: lab
---

For the purpose of this lab, we will be using several tools for performing encryption operations, among them **GnuPG**, a free implementation of the [OpenPGP](https://openpgp.org/) standard, and [**OpenSSL**](https://openssl.com), a library for implementing TLS, or Transport Layer Security.

### Encryption and Decryption
Encryption takes in input and returns garbled output from which the original input can be recovered via decryption if the decryptor possesses the necessary key.
#### Symmetric Cryptography
In symmetric cryptography, the keys used for encryption and decryption are the same. 

To try it out: 
1. `gpg -c [FILE]` on any file to output a `[FILE].gpg` file which is the encrypted version of the inputted file. You'll need to enter a password when encrypting the file.
2. `gpg [FILE].gpg` on the encrypted version of original file, upon which you'll need to enter the original password.    
As you might've noticed, encryption and decryption both require knowledge of a single password, which in this case serves a symmetric key. 

#### Asymmetric Cryptography
In asymmetric cryptography, two separate keys are respectively used for encryption and decryption. Typically, there is a public key which is, well, made known publicly and a private key, which the owner must keep secret. 
One can encrypt a file with a public key such that only someone with the private key can the decrypt the resulting encrypted file.
One can also "encrypt" a file with a private key (which is known as "signing" the file), such that everyone who has the public key can verify that the resulting signed file was indeed signed by someone in possession of the private key.

To try it out:
1. `gpg --full-generate-key` to generate a GPG public-private key pair. It'll ask for a password.
2. `gpg -r [RECIPIENT] -e [FILE]` which'll encrypt FILE with RECIPIENT's public key (for now, try encrypting a file with your own public key). `gpg -d [FILE].gpg` will search through your keyring and decrypt the file with the appropriate private key (if you possess the correct private key, of course).
3. `gpg --sign [FILE]` to sign FILE with your private key. `gpg --verify [FILE].gpg` to verify that the file was signed by one of public keys on your keyring. 

#### Lab Activity
1. Decrypt `staff.decal.xcf.sh/lab8/lab8.txt.gpg` with the password `ocfdecal`.
2. How does one import a key?
3. How does one export a key to a file? (Hint: use `--armor`)
4. Use this `privatekey` to decrypt the contents of this file.

### Hashing (Checksums)
Hash functions deterministically map arbitrary-length data to a fixed-length hash (in other words, a fixed number of bytes). As a result, the latter can serve as a summary of the former if the former exceeds the latter in terms of byte length. For instance, if we download a 1GB file and want to verify its integrity, instead of re-downloading the entire file again, we can simply compute a 20B hash of the file on our end and compare it to the 20B hash of source.

##### Lab Activity
1. What is the SHA1 hash of `staff.decal.xcf.sh/lab8/lab8.txt.gpg`?

### File Security

Lets practice using the commands and concepts covered above.

`cd` into the folder `/opt/lab8` on your student VM. You should see a number of files named `file1.txt` through `file9.txt`. Please answer the following questions with regards to each of the files, and make note of what commands you use for checkoff.

1. `file1.txt`: make this file readable using `chmod` and answer the question contained therein.
2. `file2.txt`: if you read this file, you'll notice it contains important decal secrets. Use `chmod` and `chown` to make the file readable only to you. 
3. `file3.txt`: this is an even more important file. Only root should be able to read this file, and no one should be able to edit it.
4. `file4.txt` and `file5.txt`: these files are owned by another user. Choose any method to make the files readable to you and unreadable to the previous owner.
5. `file6.txt` and `file7.txt`: look at the permissions for these two files and explain what they allow and disallow.
6. `file8.txt` and `file9.txt`: provide a strategy to make these files readable only to you and the lab8user, and no one else. 

### Network Security Lab Activity

1. Make a list of all the services running on your student VM that are accessible from the public internet, what user they are running as, and what port they are listening on.
2. Use `less` and `grep` to open up and search your SSH login log file, located in `/var/log/auth.log`. Besides yourself, is anyone trying to log in? Who and why?
